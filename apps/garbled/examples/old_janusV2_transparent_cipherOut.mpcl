// -*- go -*-

package main

import (
	"crypto/aes"
	"crypto/hmac"
)

// sample values for request computation
// Tests to derive CHTS:
// dES: 0x6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
// cShare: 0x677f7ff26ac202469e1a2d39dc001c5e7fcfb1f967a3cb4affa51185facc57ac
// pShare: 0xfbe470a4a1e11bbaa2ebb9da082924f99a20681e5feed0000e2d2b5e613d22df
// pModP: 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff
// HS: c571a176894ac7aff65d52522f4d0861060f3c3b96144567dd10fa79d218d878
// label+H2: 0x002012746c7331332063206873207472616666696320825e4f79bbcb0e8adb287cac19c378145b7d6c465734422da6882463eadc905701
// CHTS: 136513e4c51032bb2ba86892f0e3e24a75b4fbfef56d92cc0c57d4c67a847e65
// CATS: 2c1acaa6e88b118bc46287c99d7800ed3d717f9417672afc9dccd2b3656f0e3e

// mH3=clientlabel+H3: 0x002012746c7331332063206170207472616666696320803fe80818374bc995571054979e54a316f266b4908ed43f5df4752bdef093b801
// mIv: 0x000c08746c7331332069760001 (generated with 12)
// mKey: 0x001009746c733133206b65790001 (generated with 16)

// client ECB0: 0xf8895999038a3cb1169a882ebba33ca5
// client ECB1: 0xf0cecf8cdd4452c1f77a297cff13a605
// client key: 93eae267aa1f9088f1735f6435a05add
// client iv: d06ac7f19c2b18e01a62686e
// client masked key: d5ad091155c804d0f135f394a376ed7f
// key mask: 4647eb76ffd794580046acf096d6b7a2
// 256B ECBs: 6a5b4ac24efd0fc5b520d862efe1bd59cd4724e684b2740c032e2f733586cc74cb2eca5b8f4e92660a8929307d30e0859e6ae8a4a62bf0a1080ca0c28416182083a5067033801fce5df37164707be02312db499e4198fa1bd7ef31b1748dbc6f6eb2f01213ddf929af40da7c3ef5e15440abbadccc83dc0e9e207291da6d105b4ce76188d4e4b49e7837bb5e637c661693e635da92bd7633ef064ebc2bec846190ee9428eaf11593a9b226ff43646dee9036fceaccce2b38bf9c8d8b2bca3e0119750323909f7d2c743aceadcfb1f47c9b91a1032bec4e7d68f9b4ca0575b6569e378bec9f85f132322e0691bd272e1ee1925b11ad3b78ef4735880029021a50
// parity: 0x29e0ecc058100b2ee776904b2b265495
// parity mask: 0x4647eb76ffd794580046acf096d6b7a2

// these sample values compute response (server side kdc) data ecbs

// Tests:
// H2: 825e4f79bbcb0e8adb287cac19c378145b7d6c465734422da6882463eadc9057
// H0: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
// H3: 803fe80818374bc995571054979e54a316f266b4908ed43f5df4752bdef093b8
// H7: 2958b125185bf3922e4dfdd580027cc7122bcdc5a9dd5ae82c5e37ac5f729e81
// dHS: 70ee9987162bea6719acab976843acf95514f46d19872c2fabfa1a7bf32c5025
// MS: b02d8f9d19b3ae1ba8d00106dac1ed6b2ea55da3fae83b1f66677fa6a781755f
// SATS: b334fa6ef436aa7767b48ca30dfc567de973ecc692b7da661f486f25754de6c1
// ECB1: 895b8c63da8da17e9d6d30c62f09d6f5 // ecb1
// ECBK: 9b89f7120fe41972a4e81f2e63453807 // ecb0
// serverIv: cac3cc248a5e1db3ebbd2a8a
// serverKey: 2ca886649783b6cd626a4b04a96be1ef
// masked server key: d5ad091155c804d0f135f394a376ed7f (mask: 4647eb76ffd794580046acf096d6b7a2)

// used to check/match ecb32, ecb33
// chipertext chunks: ce64df1813d37137142dc0579dc7f4e2ba4f8c7e1fe62b23747998b59da16a3f
// chunkIndex: 32
// number chunks: 2
// plaintext chunks: 302c353631204575726f227d2c227072696365223a2233383030322e32222c22

// dES: 0x6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
// cShare: 0x677f7ff26ac202469e1a2d39dc001c5e7fcfb1f967a3cb4affa51185facc57ac
// pShare: 0xfbe470a4a1e11bbaa2ebb9da082924f99a20681e5feed0000e2d2b5e613d22df
// pModP: 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff
// HS: c571a176894ac7aff65d52522f4d0861060f3c3b96144567dd10fa79d218d878
// label+H2: 0x002012746c7331332063206873207472616666696320825e4f79bbcb0e8adb287cac19c378145b7d6c465734422da6882463eadc905701
// mH0=label+H0: 0x00200d746c733133206465726976656420e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b85501
// mH3=serverlabel+H3: 0x002012746c7331332073206170207472616666696320803fe80818374bc995571054979e54a316f266b4908ed43f5df4752bdef093b801
// server mIv: 0x000c08746c7331332069760001 (generated with 12)
// server mKey: 0x001009746c733133206b65790001 (generated with 16)

// Tests to derive SHTS:
// dES: 0x6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba
// cShare: 0x677f7ff26ac202469e1a2d39dc001c5e7fcfb1f967a3cb4affa51185facc57ac
// pShare: 0xfbe470a4a1e11bbaa2ebb9da082924f99a20681e5feed0000e2d2b5e613d22df
// pModP: 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff
// HS: c571a176894ac7aff65d52522f4d0861060f3c3b96144567dd10fa79d218d878
// hTwo=mH2=label+H2: 0x002012746c7331332073206873207472616666696320825e4f79bbcb0e8adb287cac19c378145b7d6c465734422da6882463eadc905701
// SHTS: 0x7691bca4c1a92ffc70efe68a178d928540f47254512c290693fbc2a8c28ab59c
// server Parity 16kB: 0x03c5c032c848a055816d588ea53d15c1
// parity mask: "0x4647eb76ffd794580046acf096d6b7a2"

// secret mask (16 bytes): 0x4647eb76ffd794580046acf096d6b7a2

// MPCLDIR=./../../ ./garbled -stream -v -i 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff,0xfbe470a4a1e11bbaa2ebb9da082924f99a20681e5feed0000e2d2b5e613d22df,0x6f2615a108c702c5678f54fc9dbab69716c076189c48250cebeac3576c3611ba,0x7691bca4c1a92ffc70efe68a178d928540f47254512c290693fbc2a8c28ab59c,0x9b89f7120fe41972a4e81f2e63453807,0x895b8c63da8da17e9d6d30c62f09d6f5,0xf8895999038a3cb1169a882ebba33ca5,0xf0cecf8cdd4452c1f77a297cff13a605,0x01010101010101010101010101010101 examples/janusV2_transparent_cipherOut.mpcl
type Garbler struct {
	modP       uint512
	privShare  uint512
	dES        [32]byte
	SHTS       [32]byte
	ECB0       [32]byte
	ECB1       [32]byte
	cECB0      [32]byte
	cECB1      [32]byte
	plainChunk [16]byte
	// cipherChunkReq [256]byte
	// cipherChunkRes [8000]byte
	// Hash1     [32]byte // 9d50ae1106944e02565772384ee3ace09752ef6bd4715a4499ea3eb0fe5c8c07
	// Hash2     [32]byte // bf90d4148ef4d053470e8a30309e373be83bcfce64d61b7ad31a7d187c1d8256
}

// MPCLDIR=./../../ ./garbled -stream -e -v -i 0x677f7ff26ac202469e1a2d39dc001c5e7fcfb1f967a3cb4affa51185facc57ac,0x002012746c7331332073206873207472616666696320825e4f79bbcb0e8adb287cac19c378145b7d6c465734422da6882463eadc905701,0x00200d746c733133206465726976656420e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b85501,0x002012746c7331332073206170207472616666696320803fe80818374bc995571054979e54a316f266b4908ed43f5df4752bdef093b801,0x002012746c7331332063206170207472616666696320803fe80818374bc995571054979e54a316f266b4908ed43f5df4752bdef093b801,0x000c08746c7331332069760001,0x001009746c733133206b65790001,0xc1277aac165282cd00923481d919c6449b9f770b76bf15f63a02c087e144f0715853f1729d92200a766040d3ec296e298cf82d263dc1499e7f1fe82115c8a3af0d03b162ee94e5267e4bb93f5c768cae72028ef51b0a6600a5efce6e4497d4e78356bd3aaff702d3297272182b2407dcd2c0c97cec3c34773cee99c8e284c908d36145eca39268b4df4d5ee99d858a5c45629cab2ee8d781188f2bc69341a7fb1cf9427fe5fb2471ae3de52a24cd707e2a19da3baf9096ab21c1c1a1a38f9f95445b598504a2481280b1a77e73c8c2fa41d6bbd37c688f1159b915f28d937dbea1dbc137c68d64e629d011037daead13dc0d68db3633f38b4ed412d7ecda8db41880944ef7fb333752b82e841cf9a4e6c279a8cb2cd5f60aa1d759404790fd834803ce6094fd4680f65c244d847412ebaf2b6371283dab666830e436056dfa05659c97af6d479b8362c7f69f86b25407b84d5784db699214eec1ee86dcf5fe6630a711f6c631564f6e123e9070727f6d8e1f0baec18c8b850165c7719f16960ac54da0d92971dc2b060c42690155466e7fa38246a3ce70da8913d203e953ce517345eaf04723a7dd4697914f71d62a0e568834202048dbe1a7d5065bee958e3b862d61d929f4dd9f9799131bbcae787375ddb79ac6dae0b782b3edb4fedaec8bff49eb2f23f235436743e32bb0e48591d22de85d24c5191a4548ab9aae82471c133a8021408dffabc37ad734b2c4b73983846d8798b4891184f62a5ca8eaba20076087c945b5b361b6ea656b3a101745375b5166e697c5d22e482425facb650986e0fa0c93f3aed927726721e80f03732b2f57fa8e7d40cfb3e2c9213998e9590a7cea3b3845f9ef3e18606b73347f8dd25dc149b74490c386e913b740ae10c90dd5373205e34528be701d2f2181e20d98ba7c1d0a6a97b497540436b15aea62666651ee1d4db741125e27bb0b5f830cee04203b222b7364c18535ea067f3f022e24268b2b69d77c3c32c1a86849dc4754f5aacbd655c4d3321199ee28c9a39d6b641cb0f23c6702941c8dbc50be8add290fc93875a9061d0874c1a341ee5e75b3943ff2d0019e5a2521c924d0b890bdfd6b41f72e970bcff6af45b5dc9151e7fc64a6f122e6ff7101cf127cafd27f8835dd2d64047dde2b79c1c731559f3e50f6dea1258f96c78f86d9b02e11e06437fb16bccf87642948c7499a59fb91466be89f0895e0636a6c434a07c135d2679d19261baa05279c6ad7d057379d1a418cb4d9db953a58ad151b56cda988290d1d1b1bddd2dc91fbd3d6dd08aba8715f262453690412d19c1530a3a5eadc478d6d8efdb6c7f42b00373bc994eb01fdc1b3cca62afec87c9466c61dee603784c99b69b1a33f33c8349279879b68d691c80a0f49052f69b95f4e795e912587661ff435fc64d15ee5bf69b23c9acba15c2dc84c552e44bfef889467e703bd1e84af9132f765e055ce47d43597775d0c6c423ec05b1e6d29f3345e6c275693c38e9872825ebb3f5c5a6f5b6d94d6c6dfe9d120934f2ecdfccb7ea642b4059a1c9c5e7d610007ed966dd8674a1947543902bb9a52306493dbf8d816d58b6113b8915c6b4dfe341b6807ab3f1551ecbd890504dc5f49895d974ed7e6eb2a8233249f0e859fea0a92b898079573c9294514af0cbd8a6236e2b44c2fd7853fd1b20d2c06fe2d43ae059f3416609cea41f0b4aa8aa55079e0eb9ad0ac8f739d00f29ffe86a0d2d499578af15b786b5d022a38433d08f81cc4c530c2956e16444e8eb089ac74e44627e876bac46502aec701640d199462a807cefe8868b4b504424d3dbee566f8ba3ab46bd969908244f898c01a46d17544e38332dd2dc9b0a9c30cec514bc41398a9082deda9c1939975dd50ae94a80a82ff747ec36458b63ca8846ad3aeca884f8b07441626b6c4cc046ff65eeb4c5e199a6633b86358c58405e8191772801d695494815d2865bb962da90c8e29c52401e2aef677674c129cadb3c00c4bbecb48da088e1816d5d01e9206bbffe2be19383f0937abcd00fbc39da4fcdbae230445072c7f0ac9584b464c5b6ff485aae535a6e646a8a8896df8d7300c576a3303f8bb9ec3f9cae6c888de1201fd9587731aa365c298fef819f1e9e6062337dad599332fc29342d5107cb62614ebb9b42894976fbacd776a35f0513a1ed0460523784b9ed3c22516abc488d2d514cd74aa92c81357da35b3f96521c30c9815480449ba74b77fec778ea456e0075dc4e3374816aedd75dde828091d3d1862f7f4ce1f7f1dc1482fd08a32813b15b2f703a2b22f32adfcc85dee365f38fb3835947c2782683fbadb9878f4c7383c16edbe24961f3ffcbae1332d9d99be299cb66e87cf508d99230446686b40a3ce3ae85d329b512a89071dccf278a773432338eddef3cfa34c13809a19c5cc75b141aebb3cc56e95dae178ec0393eff6f0caa9c21c88061c873569e7a5a9b4447cb45f4bd594d43028fb400733bb5632d57e4b10ce18ebcaf556443e09b864ba9748ec535c7e1ae8b9db9b66022f357f6963d92771b03bb3bdcb278cc9f97b05180009c076184a644cc836280206008251e0d85dbbc747b23fe70b8c5c87e4b6f456cd40f5501853f93ee5f109ecdf5aa8902d7b49086b497c276862d2f15d123bbff236e5ca156360ed08593e4847b49a4788b5eb12749969bb9a219f3e87dc972eca0657b48eace64c3b056e0fc136671c61c486768fabe070ca89e397844172bdd6e0754f667b8a211ee789047b27b8a0982acb5d5d93bb7ac60d38cc6fc71eecc4e79826e80a8b3e44263643579125cd5a2fee57db4693d7b5ed64380a3cf8ef9a9a6492982f93f301b73dc2717357a4892c52a99bc0b7b664a19555c1b27da5ec758f8ea13718d6548918fc876f93cacf55a530dbb294a5ffce1c74eb4a004eb820af74c6180fb99cd942b5f81ddfe3a16daf457d52d78346e476f4a926d9db9a8408f7f59c379506290ed80d11604fc025f6dd4be170222048870cfb31699db27b91a2a6bd14fdfc5b5d77b9f9a82603473b81df8012e6e0dd2274b4f1aa0b516e64fd898c84b1404e80d8c85eaa676d33bd05c3faefc6cb6d421d3f872a62a80fadbf37ed6c16a36f548c8a889ddb3b9db28207eb25fa15edad6e82668829cdf179304e0913ec3f78c21fb272f6af1c81f5d84f23454ecfece345443418b2e1089f4348a9412762ccab1d7e70d6e8e2be0eff006d4545ac27f55425849bfd3e33784e29e27f1eb56dada8f7d31b932bd3ccc1226a2afe86783aa0300c5def20177e5105e9b18f49ee91c488b9c3f4742e71a12d3d5c28ea51fd38b5775fd43aa7b87c16891bb858d9ffdf58223f676c59acf28288b4414ec0bc13694ebcda94e6ab973300d9abb805aee8a37482edb99a9a59d065394d480cb5119878c8b94b79ca5fde32cecd365bf911fef4147f837e786533245b9a746fc589623428c17c5f01e77486c5eccef494c4a9a8e5fa2449db2457825d6208b640776516da56aaf5e4b1eb2cffe9468127d737645312077a4f38edfa1a688e155959993a6127daeca97c130ccfe9f7c81d46ab3596679383ab84e945eab4cc70cac4cb3d14269a79162d75adee153b37d023b33a531ea0d4e43b184168b1eec8037170ec46bda137910f13042f8975362993593f1e2c1e41564a52ccbf45afd9b0970815f6ec2aec8bfce653e99bc29091e2a1209fd41dacd5e47c53eb527bf3d553eb7c786cb21b0c8c21a0ec8db01f15cb50b9b5ffff113412b5b0974e788913f953d1d8df39692f15558d9c584a2ddc2159199f48b81e0e91ee9b0c49dd63dd8a67c0f7fee848e79dac704d131e45a7eecb8434b562075166f835fef979c00cf9fbedd7fe64904df91624be477a5efc5be7e515a0e95bda63055ab0ceb770d833de2937e6962be66a7eea5bda1d62e6ab0f3241c986e56857cea54334cda71005689f47fbf3b04c87b2d2ca5f638be7f19b9acb2e5e2be3518d26e0c3e744cf0ed2c860f0766340a385fb73af9dd2784bb5f8c0f5fb364f7a021c6fcb5778b4b6f55ace9c9c139d8a7de2b86ba088cca56345fd3a5cedc26ce9566dfb8853e00bdfafaaac69591134399943638a7dba72ea7e93693730b8d9325de9412a90dd8a3d4e657cff82e06331ee2c7da5d57c4f6bc5650c314eb0e244d3f751b8f0379be17d8fdebfe67603ebd1fc29dd06e2448e450d2b16a118709e49020e80254d682007b2379b47fe85fb9acdeb07e14e4da382ce9330d64f5bd3bbe91efcd28c385c04fcc6539fa4d0e2e4adc7f2e3e2e88a58ac1315358ed4c39ac512c98be11bff0f7a9d6160e15ce9abdec78e56dda272fa28150b2135f1e2b47d1df097a3c4aafd92f7f3bb044eb43979c17f4fd2dac7477bbfc7cdd61ee455264194ad5ecc82593fec9aacc59f5c20ab7238a613e09e3c2eecbb29611e1a90096bc58c70b9a660b0a8c40ef14c28f6de5027085b1ece01d35abd66d3e0e6792434d15a7d14a367bfb08c2bf3adffc1ffd109761823d58eb00250ed6e7029f887aa7778d5adc77ae5c3d4f0e701d86b86ee724f60c4252c3bcda02e91615d92df42b2a7ddbc61d8fbfc022475f5b8d7481ec35988111b44be1d4288c4d07c72b57acc0925939a2a319113eb852c958237053783b9b617350f63a53c5379c25c3097f3a11f1d0e3f76d29275cd41ae3ca60dcf73ab4a62de3ac092f0328ecef29aea3effdc2bbdff79d75a52379b8d74cdda9507fc2cf986d1a40311475f35e92ea760a230bbd3f9f0650a2f67207579e2395c48eaefff0a169eaab0224f11528e68331a918ab840f2c318f5324b0d917b6dbeb246c8e304365660c82dc4d5b299b598f9d49a94d19c301042da7a9e25145786dfe269bb498ff1732480a86303eb52364cc2f76ecb95089f1a78d7734d7cb6f177da70d46b1328f39006b9fb30d778ac7e063fbfb0c34b0321b783ab49137eda1c97a02d5fd4d7c0951b10511c2f813c3461c0b708322ba6bd369b67f57408a011e9b2dd973fee31e0f19810e2e53861f7e2c4454329755086085a3d463d655c4323dd2825ba7450286755bad433b2f4cd3895238ece37124a61232b9ccdb1bd78d88a69d231066d3a354273ea4c2d6841931cb8ffd895cd5a7e21b156c4844c801fabefba70805d7d4439f6a362a35f9febabeced44e52572af5021f770ab232dcbdb5778ec1814c879a072e7f33ddb98c2dd19a83ab2b8bb9a3e9dde649180b4c1746ecc580c38e0bf96cbd3189f87baa99af028c904576f60960d6af4defa2043fcd0f20b60c7382dc957f94e42c9594e6948d4692f22d99481c2f648e6de70eaf44b5f35554e49f361294e521c1d76b0022542700c0be5dc1fdce750a191e57e60aa5fb86b4dee8c326ee96d25850e4ca9b5c9b8655db85ea969041cdc61d22fea1c2cb9866453ea0fc81f4beb2850983f6aefddb0354d2afdaf611de3927d84c591ba8ab29115a46cb2d55fe0cc31a560e8fa6ceb20f02e1d932277979d621b944b64feaf3df586fdcf77ac68c0b3a1949b75366adf7c72ae857cb9ea18c927564c80ad450fc608eb6fb0376422af14ca021b8931e7aa913f3bde5f37a4d684fd5ee9ccf718973bbe4706de8acb4266ff3ed8f3cdeefe24f41fd336057e656070086e0ff16046559ad2f9568957e362de7ff50ee69c23c13a162b176b5cd4e635dfba15b980436f8b48733ac679d9e4ae8fcece8f3a057fb294fd162fed9a304d2dd85aeaf723b3cbe7ff1a9f4dccbdbde688785683e52adab3657f5637def34a1a46ad15d733f6f0309e01e1530168b0ad0b3782aead341d5ede8cf8946ee207fb6d9304144696a6f16b405157a09f3ee86162a2b205ff97b2c3b749d4b32176fdb12f0f1372943dfe6269baa8a2b3879d14a0131d57cff7f0c236fe3a6d66a6276cffd0cd69c44be0f1d7791e7f72a8da4e744a69d0ffccc8f87f500a7180d12690ed4b40c144cd266d6dad4f9f23fdab7732fe4423470504c53609ba862aa76aa2caa35a1534c19b6553a17a88b2ef479baf2ab1997ce86d805f41ea27beb98b1f5907392ca6fed14e455476d35595eeaf4ab1579e41ec5dfd1f8ca3de962fc74359542462cbf2bb4735702e32f3eaf00c72ea60a869201f63a141d8ba108f9c32d77665aa8f4c4bef0acc6e878028104eb6ce161c684676386a259cbd24b5b6eb0f34fdb42d5608acf42adf8f36db4de4e6a3cb77359e3e6d2ced65dd25b775ead240714ab21fc602a0f20045db9e271fadd4005287c19e643c0fa990eced33b19d343ad61238f0c42458cdd23e8d0d1a2b116aae00c71ec4531ea7f2228127f02e2d017a0ab76a92d943a2c0f262db4c300954ed733cc6d7815d169a3c63e1356ef12c9582e6250ea521f93066b5e064b33b8d8b92ae226eff656d592603fa9ed37832000a670feeb3c3625b8d172a3e1de53f09ba05e2b72356a2885e18e9a6549912488d95ec5fa46d0289111e96dc20f95097a648d7e32a8077545e8381a6b27b444424db511927c23095ae34f554b777969b4dbc2f8f560541d653488d17885831425121712b69f29ceafaedcfc5be79db464b9f86f36d289d13f76b778f52bec1ce3a74a09e20059ac6f9606fb0d4fbada10453dc6824bf75404b71034988508357717597a08cea3db13619eec1800af44b92ec75ff0a8fd22310e99f1b7f203b179968dbcfa6939dc7d67d9439b83798baca4f90a228dc0777ed75bdf19b7b3b8180a99c996b2aa26819ec96dea8817c93b4f6acd8601c812563d5ef6181aa34c8766234ba16505821a8e9e932d75acb8ede1f70fe8f7b2f612ade8ce3f5654ee6e53463d546d78a1137c62fdb8c8962246e66771b90483f944986464eadb624adea5cf830d3e37dab0cb80122b974c9e9b99b4a2d7c4e39f41da55023ccd166a015c511b23ccc9165a9c2dc55e1f8f056ccaaa9190c378dd0488d0c8db8417f36ab2a1e413c0bf79d0bdf54270ac5ac714e824961bf81640ddf3d22b5307bffb21fd9a9c1194a54b2ee6649fd9fbc7320f7418ed476cd7ec8dab66e687f466c52f0a9929a170385c8b720ee1a9e0594f6f5f16506facda67ea21eb63f71b9749621d1b6a0c8ec0d5e21af87df0b29631b8397ca2266c191ce0a8de8ed19c83ba8356344cbe38ef7ecb254b76c99e6659faf02f55df17ad2b86a879e4c32dbf636dda5337982bae584205f61e5f2ccf443b20705a39bd7167d5cba829a55a0c67e0aae9c1276c146b706ca67c7515154826ed825114f8a8d93e0819a3360d226697ea265d0dc001fe617fde0b9dffaaa0586ae66435006d8f05343b006529994d62c56c933a9da7c3df5ad0df97eddc8831e7f9672380bc158e05bfcd7e918209b1ab527ffa27d7fb8112d4957c4c5f41d35192423bcfef0a1ac11dec3d559f9b983e6e5c42856c2a469832915e557e9680a1cd6b77655075600fae449c67f95858abba94a1e02d940f4ee56af30f4c8fba9be70027f27362581222943fd5a04ffb40dba119a1b22f5f0fae178509b2b5ec31e374c222d4e68ff0971afeeeedf9dd61f3d7838a897833a5b232c8c92e7b8586b1cf32eb221148fbd7d618a6817bf3937b2768122da0ae26349b0fcd4b077e391e3ce58fb275afd471b5490d6a8f34c5e2eab5a7b878d51c64e98193769012bca8e8719d91281070ba4e893d4f9e31bfa7351e38867f921c0be83c07c1ebfc94f89f6dd418f9e34d943d3448c83ec813aed3c8323cf3541638c4946fc5e68946464bcde21d6d09b7cb9b813b161fa09b0b531373f60b9de78576d9066a7e6b97e8a81f4048f04ab582f1c1583e52fd971f4c3a5ed9888c003951be56d4b3dd6bc935e90595db835c26d17d267cc368971047bc772944d60c701936d0b90051ee24ef35d76c5e7a53c67b39b9f1476906e7f26c0c3c282b7812f695d1290795d9826645710c64ac4340204468e0067cf99b8cdda74ac2b3a66569c4714dd072e80e6f2093e8211494f1bb1f445109ef7f824be6cadf5c36ed896b4f39acdb8576d46e8934b6460f81f459482e00695d27dec6c9fd198a907df9e98485e595c1920dea74347e020776a2724e134ba3ad98df70c5b8af4ce9f6299d2a209364017e0d123a622883fce63f903396adfcafe3966a2f22ae8d65dbd2a1242ac2724496c3a6d8df00de047e342284fdd9d57c0112f891897c519333e71ea6aa0618c3f59f62b28081c616ead55a78c8c7ed4e9ac8e8a3e969a3592a7852897e3c53b4e5a84515e2b8b5ae448b5b142665f95f479c78da86fbc8e8bc245ffb4b3b2b8aeab22063e27973b4311cdd75584e4f2ac343b3f789963ed3f702b61e30d4cd1cc25430596a95ec6a2301f9bf3732c868dcd9f21464d8578054d16b12fa7ffc0b784c7719b7674a7a812deb18de0f48cb952eda8437e2ed55be40a1fb9b92e263bb8b79723579496b36064bba193848ee68b6285f45dfeef2befb1e5e7ae7297a0afaedf564d1547513429903af0e34cf9fba9bba5f4ebfe54559afa0a916fdbb90724207974e86b8a0fb50093a66c890dfb0ae3aa40ee7f45dc573d454df1a9861e2d1d525ca4e98b6d174cf08c85c77513d0625b49500054832d1900d33904ed7ecc22846c228e964b5c5e6c5ed6a9e2d01b97dbc58214bfe120171e34a7ef2d4378fb7e6196253a7c566fbded92aaacdf41844daa10f143a807fb00e5810e113765fac65b6cb5fe2d234ffd67c83275db49b3359b4a112a9af447dc63bdde1b86ec86e46852f3783976d6e1210d715d45135d77cb329212bdbf0a8cdee349e6fced52ba56539a4edf57d95b20f83c2a5bc7e33788a378596311a8d5e4f60eed2bd009d2c437e29587072a5ce8476ea520694d9509e054ce9fd56b33da4534113a3e7ef1082c5ace6587d9cdcb4ad4aacaa5a23c2fdf1a415035054b1335a6402f92d337b248b17fdff501cc22ff4d2cb8f9455933466e68026740d8394db5f2c61212b729e2c4d347d4d48680356fd6a89ea0b5a981ee094e9c9cb70c13a41cf88b94cb64cd4b8b7beee80dfc45240fc404c0f3b2273a1ba9d5593dd2a69850f88a80fa6ff6fb9ea3fbefa5f21731cecb45fe7959cb2c4d083ef6293e588ae39f5b448fb34fca90ffe32dc39e6e81893bce2fce763dfd399d973a47a5bd0968f555e6f836980227b751027a41364c2215b9d24152a891dd24add14c5a1288d85a746afb071be4b1b4543553e574f263e739a440c5fa8ba038f9b4498947cf33d28c33b634f109b0d191e001e340179b5f941c1ddcb357773f5856b2858e91bb3cb13dffcb6374431b8499845a0f421e94a4d3b7ae63cf3ca10e97282217b2c48653b8d0244269ad5fc857b73690777e62abf740877afeb55f0a1df830750a8ba3fc7b1b50b3957dd81b7c103c7fa4b034a47c74b1082382a6ba4cba712b9e7d71520c18e15b2d0dd9a4f2e5220d8ea9c73db7ad36a9b3043db6d75fc9b047a6f87fb6d364a77d8b874fd916a3a72b3eb12acd037e7544bd2526dce17870757d5a17b8e8813f2807ed039dc4d4e0e2acf40f33124ce315775bed894142f35737031d7c115803a0ac9e4e886e2152ee10bc54cb1dbf18f11f2824ef7f6eb35493b664e7cea0bc19d3ee1c05df648f24df73606831593d5982819ce99f191ea40152ab48b723995476180a49195b1a2cd38f0f19b701dc10d2eab9906fdc269af1bb2ce33f183f9eccac1670ea561b84a6673acc6316d0e5124b03f53861f466c394236baa001cbc1eee1b92771ba9d84ef95383390609342e4681ec447099f724bf79b81d5d7d65e479c93116e467b7d558a63e0c11c92027ab2273b3f9452e3f96f32e74fc4cf344f5d0cced746373554cb6d29f740fac7f8b82ef623c7057e49412d995bdfc4480a146f5cd59760efa8e2035f5562cea459ca6cb7faea926d6dc9a38be39b32d3f635eb35aaba4b2b4fa5933ad222d01b72b1d76902b99cc0a51e7fdfd101a52aa00365fcf6f01fdf2562c58afd5e20d226c10d5b746dd154359798b9f0abab2a9a773544bd3ba928c8dd41dc3da37619ebb9a76e183f6f1974fac3ebd667617ef3a14620235d5fec9e19ec436fcb061a2c2d1465e0d6c5ebe2491150afd673c043f8f405a98c0f27f3d256c056de0d76149237db4ded86cd6e5d8a026d2cae9667082903037dadf5167115b2f463b689305fc5448c332e2989e879736f56c72bf60baad598be68b1ca775629feaa5041460d10e537ebe0ab9c8115f81983f78accdddef08f6ab695c9f810f252492c3a1b7dacb1ff7e40c0a249d8003134babeba329c88e6b26b98e1920fb676084f524885ade604f3557092ad4973e1e7a0b8d2623db630b37384cc8e8609dfe6ddbe8b170e03b78a922af2c7b267aa43a34eef5120605cc9533dc622f607f801bd26ca8c97aa0530cb99957fe408767d8be94ab62bfa2a8c8cc9109c2d2713e3587dcfff1823824f7b5352053aeef2a0c2b3aa9d338cfd7b21e610f09a03ed79f1b04c98eb393066a04b831e9d4934a141b4f36b27db1849605a33c7c1a1be7033ebed15906c7f952d065f45fcf5a972a8361fac733709b4f69c03bc790d72ae78cb282373271fca8e950a803f8592cc7b8f16610c33012e3a8ecd1eae8343aead45acd542bc8f8f16f7b805c47c9552740cca7784bb26d8aea32022fa686f7ccb0fec2e138377be2ad85d097d6b774140bee392e3d27780e6568dca61fb3b4cdb16925f953f2d0fdec2af80c2f93e9a06475ba2e9412e52478a733c3c66428e0e7b1bbc9de111dfa8525ad2dae70fe365f626f4ee1e4570705b5d286d1d6aa1aee3eef4b3ba0a8cc27b981eb0d5665c88d126135e887a5a398cd15c784de41210026de031328626fee134c7af3c3daaac4eb8bf350d6ef5917c925e36f71e7add38f58d53d93a5af287ce59b8bf0bdb5bd35ddaed82c78b4d187aa9fc24dd6a45f8167c69310b31bde5f29c6d66b0f179b68114972941797c110667df5d9f4a16adb627a2e4fe30eb65c6382dc95263527ebf7617a6a5479315d0343fe01859e8da5aae6975a28fdd7d8d335c0f85d508ddac568448c5145f25fe4cf68b10e3dd1b688f6afe9fc5ac324fc47952a05598ffbaf02c8e359732862100a4f048880dbdf53623691b6c3f12b359f008f4d2b032effeeb94f9109db55fd5074b8ac9037efeb75f3948f95347a43e570ce326b21585b53ddd1497e16039ddacf4cdd4b56fa4506dd096104f51da1aeb0f30964b281a93edf72a637dd0aeb81db42d65b3799a1ff3ea0ed6de9d9eb428a1a57d4cdd269d46e2091fad06c96573ffde001f077c1308ce83e201a00568ee662133d694e5701b1092fdc5aa0889d3adb5aa0f667d4f1e3d6b40282be23911fb337dd15c6c2b4ead0323dd2a53806cd462af9973406c64f92e0a465bf5964d88fd05be33f7b95cc302f5cc511ea63749de1998b94475a97ff404e2457b4ba2c2358cf5bfeca422d677c6c4b421688224710ad26bb83902712da3cf5dd08fde5a2e5b62fa5d7b19d18d873f561932954197846bed16edb6a15b8b6704a5b485d6c06613c291a947c63ed9d671e26aaf77d0e3317eadb1bb988d561a21637d85a7f8991445acff02501634fe2ce701c532c135d2578795539f446f37a774babe5acd4a32ac4ec629d9c9e9746beb455460a0d3c50a705bf3e0f29151f432d193bf9545530bba58bf0b54a1315856852ceceaec410609665bfbddf071706241e135a4dbab61b030f50a2f9a2916475ba1b86d7880bbc8db53a2fea546cd3bdff6e35b2a79038e49398e965211588ac32bd36dea7ee1511f16d90545b900ee1504322d8f165bd59e896325120411add19fafe3b4f9ba136ee415b1ac1ad6604b8707f2a8ca38ff2387c72b250baf8f91d3952a2bfd8181f77d31fe06cd0f7f15432b27d03524e01b1212f8e2623a636a64df99469d042ec2b0fbeb7f1b6e536128b59728530b15b2e2c9d018aa29234b58145bfc8e68edb5caa2149671c06358e7eda490e11af429e00232f687b6fdb3555f0db25c1298481c7839fde97060fc97979ea17b0cdf8308dea73ee02b7765beb64badccb72bf8f5fce9ac4bfcc81990def0a29933f049cd2359206c3cd7c5fe5ee20f31e5fb1398100bde5283d56817b8b2711ff9143928e6ca28a15d5f510f96dacfc22177d813a6c3cc33ab3828ea2a26edb56dfeea3651a070597cec7b8e1983da280342a680a3781792770ceb29ff61657ffa41c436460c5e49c5847ad8e446dc08f4810d5ac5c19a3bef454fd8b10f869e855d14624d2c603af26743d0d68a217508963e7536df8758df67e1e1bd6aa18470cc31299907be6f16f6dffc62d8d5f1e6251bf9cf384ee90fa4a2dbda1ac5249f961e810e6a71e7bbf5c4e9167228104da635f423040fd3bd92035b13fbb00f1e0fd5999e78f2ca9de99075a407d806bb0624bc58248854ef6786a6ab1cdf46627b6c88cd51d252f98b651ac98cea19bd804a7ea4d6fd56170f7d86eb81cbfa26f84519d4af9361f1c2834fbaf4802b11d8a057ddd5e1a1e8a49edecafa4dad63807989e4f938fdb4e91072f6fa72857af8b06d981fe444f27862a7d7a5be67fce2ba0a63c71befc2647111bf7d61f613691afda9f1a606ae72ff5a06684883a8cc04665a621618641b5809d766d85fe91514134e5dda56d775fe340e4710acd5b6f3fd530f9aee6e3871d6cb3a17961387d9e95bd40f770f2655bb66c8fcf4cb6f8751fc35cc3885e4a63db84489bbffc9bd749c022b54fe9ed610abedee18286547b02ab813687b49737c8138097c6d240fdf07fd77ff14191010dfc021ac808b1dfe45e67266be269d57e6560d5bb77cd3a65bb0f0ecbeff3dd522f0ea3288bfa07903483e81f627ef594daab8b901fe984db39f2c818db4a9ea360db821e59b6fbee7bd889e571a500e49e06fa98de7c33a466a042359481ef176f8ae707f9c9dfa15c4d10a2b95f860d79728732158161423ede353324b4176e9ffd8a91e2262a35005e2fa83946fbeb8a5836f9e9fd3642b03bc2658b4e843835699e63e0c6f9d5a3aacf67613a34472bd8b8501a8ccd46ccd8baece1a7fd3084ad9c8d40fc4bcffa61366452d1149e355293ba6dea8a75fa303681f8004dfe487f2c613a3c6f96f500b0beec0eea8722f0288651dfac47faf3a1da7461d254e42228d991a53ac7a59ba273e7bc486cd5b7f28b958f0bdd2881e99ec70e1ba7659c87e27d67a630ca444c4c18e6b32b72225f5074c956a1780b65988b7a72356b29a0740f95c2307594ff5b653519239ca5280cacb8f86a80be31985da889825cce26178a05871108774a32600493cd9b43711485591d5ec380f1af4fb6bbe623fc283c10b945f02c9abe63e3c10a5b2390240e8d0c3b5cdbd3ecfff9e5b29d1d13f0c8b9d1a7c8c7b861b3959b5149ef2bb8c7fe291515b6a860893ef3a7a19302252bf31ff949f1baa8e211ea969ee703f8d7af427534f1d1b7900404ac52aa5bb88695a1c935548e15c6aefda2c0a66d6bc10c7bec6887cad9ae586ee0e2d887ddd8e9bbee51274d8e4f4faeb6063c5758bf9e9f1fe5b88a0dca0b6a5bee3b4e222e0583127e15222c7b9dcbbcc0052327f6de70c6fcf597ed44cc6dbbf8a448b72a57c42289776e39157a39a37befe97491b1d5b234116318a523c7a7a23623b108b064a223168db1a6d7a4e8e6955864d88d755b6939a2f1580488ccd9ad9841ceeae4538ab6b7a69bc01a0fb2c68bed09b5ede46f958b02c77703d691320f7548bfb9080f16ec8493694025e474aef0dbae66ae083dfb89dd7117fb928cb2a21da31a2115a425b1e2af1c112ab6b91a78d5b51e14030f314dab81715ce13b364177fb229846db6da881b2aa9b6691a65ef6b320e2ad8b543dc5a8ef34b2988446e8e0ddc64451eb789a451608920e45bf286cd6eb8d90c06b8705b95fd39e752d7c5639df3d8cabb4422f30150d429154518ee8ac2fe3cc1047c15b850a7924e8d98a2b50145c98e2624f6fb5fc16ced63ad7d70ed0bfee769cf019499b28a0e14321ab74861eb1fa5e7c4f7c79d254927b9222a38629cf9e54608d215be8953cb5630919b30789edc8581b02956f2d0f6247a1b041609af8b699135c12c5826ed4e672170b121a5dd54bd069d4850b0e1487b819e01da8a157ae83f1c0df6156ba1d842f50f403c58a9c009ccf735ab7a987dc3b629061e7cbd73a955935d7b8b3d0a646356eaf72524caae01a3e6c80e26ef1f7bef183ba621b73694db9b8bce1487bb154d7e9c801d5df4cb02117fa4cabe34a68ca9ea51886a6be56f8e2f66c60d65102dd39f35ed1a3619f7b3b5f57868d84c52aede724642beddb95c8496ad354f029cc1fd159b6a791a046cfddce5658db6aa839c29c011cb1fd4fd68e4cd479a3d441cac6f54fd84948b96247a8f5cfee9e83799d32721dc9e84a8313a101202efd4c3df93c01d464a88c176bda388af1ce3426cb844f8ce4b9f5fc38ecc5470ea7a2fd6a38704eb38e2718a29f58efcaf896ad7b6fadca5b5feb3d7ad11150c2a2436ddd4d6639399a232b74b8e26b02a99efc9d5ca2c720cb92342ddeb67877271e0cedfc6d1678d775e0fe411e038d66c549a657fd30fc9171b3a1b91d163bd3b274f1713106c492603d59d00dbd149c981e1b15105528b6ae085ce41409145fb7262148d2101703a7a262ecabc759da825f267a35e2b9c2ff6b8eefbcd66bc1f11f40c2442c17d1d49c93c98ee7a2d15fe25819da835198bb56e0e4f57eb4aea91678a86a6ffd4f93e665cfc52fa789ecbf454a145076063ba1d5202af494c8b8f91af43487f2bbc7b32778e65fd7b08d59ef4744355f8fbb05433f9bbd7e26b52e983d558db439d9d5e2a77608f8f986ec7e6c7843246d7dea18f7a938a74f2a26bf19980981bf24a29b0c1855c649441a9ba621cbc017f7c1a73f225eb262e2600ec0528678d373a658892c60a290073d9f5cbe212d18c8a9f58566b25649a72532405e3865938ead06570953f56d3485e020ef08ee179386f63f8116f97732eeccb57d9d4d6c621c963d6f9577d0dc1fdd51e4cb53e1a3714473cf07831df03077092c61312b8c0cc34caf81f2b1a5e7340d2ea4606480f89bd217393ef6e726baf10b59124c5e14f31030bf9e0cc36ac466121ba1d55211eeee57fea08aab2d9ee6eee021da285976ff23bfa84162bdd04d523c3e7685c0784212f4f90681e4b2eb79d6f78fba7794fac24eb7cabaa4e125e1b15f503aacf49121cc640e4f26ffc7f75538c36f73de2a4f3a3222c0cd9cd1a6409a4f5bab8f4199de2b37af020305cbdbfe1eae4dcf3793e2ed309c071a266479a445895fd9ae374dd7ad11b1f02f2c0ab01c17864462fd8a2b2de86dce4d40c8a63a18c7bf85d6a73e334ce72f6f536d3f7fa47d392c54d0825933381ff0e6841acb2ffb5fcd7a399b5ad11f73be64da53106206ad92fb7eccfaeb73bd62979ade6fa04f7ba73fa03a00438815147aa3394bd12426d9da7ad96b6f466947b5e70950465a9d9a0e8da7ad17205c8710ec32f9ec45bc45c876e49fc565529e03de34a63617a8c07d25879417d8a5183d3e9084742e1e240fc3ad0609cffccb03c907b87defb8088895db800f6e1d08ed248b619104253286f8c63adfb74cae12f2451a5c935b80f77e1785a5a75fad17c8a6bb64d4b1ed06961685b3622ff5d2c4e862a72c4e3a5b82d4c3421f5071a28899a477226ab2a50bde9b1317da890e366b04ecfb7464f1855d6204b68b9766abd6d81bd9bf2e3cd98d61afb3325368a11c9f36ed37bb788fae032b5a2ee5f56441368ee07104cc5af23327759a60357532e98c41eb8c3eaacadee2b23546a4dac105411748091453a57663e820ab99041dbe11c4dea5c35ce9f1f71b34e2c6e0731e79558c080bf226ff18d07f7d8ad0c3b3c7bf6af5a6f15ebe89ee12304855c3d678f3bbe25d4bb5845c2362b8b370c8ffd2ebb722aa06836a617dea15ab562ede9acc47a20671f32d4cfd46f0600769424d4d7c36120993332ddc39f6b8397a457122e7e54361d38f2e5280819f9714e6433b868e8f107dfa036ca2fc28f3574e449053135686159756c485cf922dac373c27e89b1d5353ac4fe312c903eb75e6d910f0e3a5a6ef645e0de3d78355efd0e1e8fe5108bd46750af8d4fd86708a8f57dcd941d940c5ff897ff642e3e12ed9bb4bc81f0d9c5a322d896225b537459faf0616ca994880d8338c3f4fa99908df81d1c2fa495519d4dedd64efea8d0a4dfddd2720ab08bda861a4ef43522aa13ec77d3d5843552190c8d107e8acca0b596800e85bd405f9b2a7bfe9282f2340caf60669d35c18a66f613cb720b1ff5a9ba7f41ca7c33c0c995cdfb66333cd9d86c523c68d1f6bce38189a3437d45a08a7356ca893f1f5ee9c3750a19f6a06209bc0a2d3af0ed17db5c8b46e1190fea95be236f81e7d8470c4c820bb0afd5fc9befd38a7885ed87dba9ae181485a387ca48ea94e98eb666bd8db0de66366ba2bfb15cbf6c16ec9d7e1cdc16d232bd5cf714424f86a8e86e13c9d26580960e3932a0c2bc7d005aeeccbd4fe8f256f63a02baa4658928be27886bff278be1566e1722d1d157359acb2ea0019e6c7d0baa3e1abf2fafe7d1b955e5177a19607b5cdf5dc4194cb01bcd638f93145503e4b83eedb7f583b010d8de261824d3fcccd63bb4ab486c4ae47cca92be8a95eee4a810511b4eb39468dd4d84d620abf3a9df0b85907dc204f3daf2dff5dd74300910bfbb5d18c416b567eb638d03de267879061e34a4f8dc7c7b67f39be468cad386cd22da0d6bcd0dadb4a7b3d25461854d027d23dc2d9003c294d13f30cef5d2d37c74341c98bead8f7af00e9c9946adaae6854123b32b8d2deed22f6f358d5f347e8aa3751a720fb27cdfa87a319e42f75f2db2fc5b52e451cf40aa5864c418a02ad05c84a5e8ccd390612bccca9cf601fcd2a6ec6ce629fb3f9bfc0e949ee66a671d0b7a3188039253799156c1907576936027bdbd4453cbb38cd3877433267a024ca8fb1cfa72237fadcacbcda7df048edc090e2b423e72ebf740a18f3060a3548feb9bf5ad7fbf55c9a56c7bb268f0a5412981fd635e046846eb1cef0d5fee5e9c5ae432a847aff2d38dc21351bf08ff1dc96da2a3d763fa52ee33d859b070f65d6781efaf67576aa0e9a6031a6ad5b2f4a91e1ce2e50067e8589c6bf1050db3bff774958291c42c8ae51d2099fcd0c0cf3343e0c12571e32a0c00909fa3558ab2f9b2986637c28f57a3bb806673046b96001473dceabe74795a461a58f27987bfdab7894ce75b7e4080963de6b8753bb155afef4610d3e8e9703edc45a62e724d06544844cdb3bf7a6682b28712a22d8bc825c42006652baad0907fafee211dd4e787fc104af85abe6b0b9bc2238431537a79ee94cca47fcc0b980e7a27bc512fea36cfd4dbb0e5b42d1ce94ee7daebad2ac7094cffbff67c87b520b254662eba49295e27dd672004913601491d818fa3d33b6e342e3bb385e3f179361d4d337115668c9cb4f311d331b8cf491d91ab5b938bb5b99252eb57a605a3b3b47f04c66922ec18df6ab6f015934e79114ac844ed39156e7f9b03b5ad4d04ce889555b263bb0e0c9093064d9b98e999878464311c0af15a087e6dfe2b8aec3a2eeb0a25dea2ecc8ef156fef8cf2907f38822551e3df9c7dd4442c0fb39b910d34d263639c99c565637b962c1172df61750e404c786607fdbcecf7f68be84b5c6e665742fc72fa993604da6ddd320cf3ef80998d18220894094faf8d3c3ca8beb50fb00319e332c4ab4d34278dec2e0682532294be4434fe6c6284f0dddad9a897c63a369f7467e6ef4e54ab682b6b559db51b9230605f9921e1e4975560b8dbb3b7cce85948b2d74d2857638f8a498c83a66ad3be78236f0d5666b660de969e630e58325897dfe1e13774f0e0aa33eb9807b0047a2d4337993cac0cb8bafb7e4cfa31c372f1347fcd94fc5774596f87ffb0a864123f95402dafc4196a1658af1c96300149aadfce2cabde17faaae3c79558ba3ef0c1c1fadf5b77ec934d98de055b8728ec3a426a68617c1700d689bed202ffccec75f275f867227f985da9b5c86db1bdcc0b4c124d7e249782c4e3d532d2d062062b721dbdcaa7d7b0b9a1b318b210ce374a8232e3d397f87ceea379863f9bfd788d13b65348c881d064c68eb3624d4866d30374840e267f6d0285e18ae98c0c16e5dd30e99de904b2b30a2d30b53579b09287ad4887a67f1ef9179f87d45b023708ce8041da5eeeb866d071c1914ef8525b6124ca2efad4fdcb03ecbf797d08134a26ba696411a1e722f4d1cb64d3f3c165b2e1810ec4380c92e82646a79c2496b6a9ccb4c9cb699139c4e641f651190b61818765444d63e1f9dab423a56ca8985c49a6bde271e47a3e69d5b788466f4c526db8f9371c0589b2fc851966300985e798efb7e55636623d6782ff844597e6bdf940589f58802d491d0cbf2fd93874e7a10333b318e8059bfebd5dd958a666d84c38a8e75a2c242f2caa13a238e76acd72a3b3811b5c7dfe51f7a6918cce36f2774b9a41bbf4a55fc19fe69182c5d8ec880f879a89dff001b5750fd57c16d9919d59bd1815cf0b76cb628374e32ae743eff8f89b6d462911aae65d5fef687384c4dfd9cb5da9ac32617e428a607c03a5b54c59eb316b3daf30f8ba2e1ce59d6149967f6d34fd81399b219ca5e4bd23e3ad246096c901030eb1226f44cc7393b5cb808582d8192847a810092d0c741ff24e679c9368f25af917d3a8ed86ef549cd06324c07b05d0f4c6b6ea9649bb209da15a1f25c5f43c139fa91919aa5fa801a251dd5e81aa791aa745ca61fb7dcb8ce8c1b3e56367a78a407b64fef0de78c9cfcbbcb74a9d4c48b93c4fbbf1dba294fd91405822f20934c045312069275d85faf0f3c652b7aa33e50cfee7cdb358a4256a46c13a0018abacfb4e1243727669ad7e3ed6152f2e888c56710add66bd5f6899387b32669f8de01afcb2ba8b33f04f9c3b5cd92108783e3e19f2baf369a895eaa64c5cae1c6a5e61b622c90add00bf852594c83d01da9532200189deddfd6ddbbc03fd6d5f76efe20da6b01edd66134a9ceccadc56abe6c88daa8eeb7f1cfe477a102a19031d198f3ca46fcd5702102936b540368be70136dd463e736fd5e1375eb27446c5fee662c1223983ade7e5084c7394b619088d23d111d5c529f62e2f205ac633aba9fccb3a309341d04577e6d544a8a745da00b23abd983a7329dc04562320babff9b8dc2fd21a4a1ff32dfd2dd9fa700a534557540a69dfc68b3c3cd76548f7eb468d4bbd3cd6f565844a8e7600e8923f63102eae059c4cc5aae3973c7748cdd0ce7abc28a0266c44381e542668b218b73ce0df8a99cb36d38c73876bc50bbe220f6692737e51a4dfe88e12ff00358b93fd648dc32719bd3c110e7f840c1c7ccdbb61991bfdeea28948f3a93891475800eb8289a829fd942cfae7ac80d5d3480077e1cb949f0a637f3526e7cbb31df27cfb8092779685cbecd5c2c70d3c808308fece582242953c580958cda210517877539f247a5e7a3411a64abab009393ff645e464f88cc2630274dbc57c91b5b4f00ed32ca61e9b6b8dd9b39b41ef754fa0b06394ea86f61cceb3e40ecb3926f365339edcfd1e924a096e8b1fe34a8e9a43feb3cafc4adf72ccd5f06e8df95b335507c6244c9453fb80294af60bbd1c5b32cdf24aac825b3ee8f4927aa995aa1ec2abf1ded693ddd47f3ea542a458b96b7ec65ac2f6fe510062d9f9ee2e289354e0e542f9d4cb1a0ef6581a37c302d4517ea4bfc72c10e39a122ff7b1183261f193374e38b17d34dd25f1314d8ff60c53e6858e7b6660bd2882790b420df4fc5b3ef921d726c161bcb353b9bcb182b16ef2c3314e4171b5b14c10c47bb7520848a58bbe4918cd80121a709ba8b39e4eac67adb2d0f93207df248a5aae75ac6476b79bda3c085bb9d934b77b169c0be69a9ebc41aa6e0850caca95cad3f946f2c6ec296e3bb1971cc2f48899abfb22ba608cc60688ae7a6e66ae1fd52f41354e8ea76992fdfe1822358a6873b8c6a2bd3e39f85a37b35b2e64f252295463a8af19819484f75343fac4ed266b3ec2e9ca27d839ac1d1bed7fffa7ed9d187b172fce1916c26308639133508c9a696d37f16f8cffe7ac90a8a8d411569b4fc92be9406821770a49b64f4725427821612ed8f998c24885b32af42f61319d4caf3716a611385fd55160928d281a9b9b6d50848a091992935835430e1c2d34710cbe37a47ecf1bdc7e722908ab9ee6ee588f16c44dd6c095c49ee15416e94187a8de1ce9b457c90ef2fac06e70de69ad74c33ac0530124a9fd4bb68ff4b84eccb3ce64f74e80a742b4e8474db5e9654486269ba8467a6a6bb6907d757520497ec13a8809a02915b43e7c591fe0a23f8d3082eaf77435b0f0bf3d0ede0693f52ecc055d29e84d44f0014ff532a38f0be50045f9f5ffa17792d6d7abad9fab6e8d3652f9497d81a5c6277b114d5c5b65630065a18450f0ec96699df3104d84d99c961a6446767c0f78103028528641c0a45b184d025f49b741aea8b2fb6fb1747de412c2474e0d64ef0f0589d0056b11dc50c793e0c5a48e6c9bd475bf36d2b77a22493a2acd0e12fe4f3514f731b352d29fa5e48fae46ba4cd6b836ea924dc5bb2598095ddaa2af86864719024459467a48ce113169dc364724fe23ee9651b114532c2054983bdf39bd50d42bc895ef04d2d13d0c215b6c5dd8ad082a5fb88f1287d610fa92a2871d6b82411ebce55df42805e9cb7ab7fc08733ea37191ed7c00504d597349d5ac8bb4d299b001ce108fb3a3d48448ec12d6d4416a42f8e8491a0e303cd9eb2bd1ba259345fae3030d272b0f6e7982d9607d9aad86ce3e624cab3e1e88575301c96410e1ee202ed7ba75e1b5377a66c84a56da355b30d71e626cf770e3010a178a64438eedfda81dd936be984e502a46d0af010febac060591ac6e5fe7fbfcd451e91e7832c79a41d72cf9b5e25b3363dc4d4de25b8698e483bb080c9e21d5ef948e321cbb3ca37f9e23a7d2db413f00fc3d7ac193940a4439c8ad26f03e2d1dcf32cb96ec8e080ce93870946c11b24fe011e70b371cf988441d0f2e8b5f2530cf19c7206ca184fcca6e485ca2a4482d1af144664fda1ff08853e53fff66e6170eba623265717e04169266c86f48e7fb3dca6a19c134f16a75ee1d19d2322b993738851eb55b976a320123bb71ae6c8dd4222424a8e26658aeadfd8f103b7207c481c706c4bb8655434f1afa8a6de7be19f68b46fddd8e8a8c641f4a2ff65b786ba973f8404e4e97771b2572a1495e76f330c9b3a0bcbcf4a3433362bbd18b684c3d3d4c6ff08d1d3a8f6546fd8e02b9d2fe29f1065197ecbfa2433967478a7d3bf716a28dc892d6c3d9c9487c32ab535bdfbf93dfd0c6de2b5c28369e5aaef14c38c079d86b4e49f3a61b455d71138d6711f301ecc7048eb7c4f2066e7ed9e3d703b6b0542d47655c95e8bc5fc4f19dbbdd5a24118163982a9b94e419c92c6e71159727b5cc01e14f6e27105428c5cea498d2e1cebfab9029ab2b1204d5d1122c0d91f31d9e58bbf4ad89f8a44861e65d7d37ef5fc2f0958e54f4d67dd229620a4e5c20ac49bb328a46d12521acac5848fc9166753f832b756a7660912260d2057a53c855ee2fae65d1ae5042e20752c775fd2b9aa3feadb2bd1f544fb5ab69a719ab51516355c91c3c8012dd9680e846ff04b3b555edc5c79f6108f5183e88ce868a6d8eeee00bbe4a85c20fb19b7bdb4411ead7678c7a70d2fb32766894426da0f230528943b49dfd688e5036e35294f8312787d71e5c94bd91daf2edb6e49c32813badbaee5b40d14fbf4dbfb6f32234293243eb907431850559e4741f4d66a43d8dcc1430fe7f83f6de47251243fa64e9b3c37bcd50d9c81829f6fdd734abc4895d328f957d6f3bc633b2cc9a1bb04a4c68c9fd767248c467426f90c190dccb569868d7c05a824b06bac4b0e0032bc798180c3927904f0289832f1e1f088bcab2e2eb65a095a1c919e8eb4ba79149a0815f2d7c82a23f1a408c734ce1620682055f59d7ec57d1317827c7c40a74d31c74cfc05a0212699ca365ad8516ee46d5f5433788af7d39e4050eb58238d828cc9a4913283d1b404507f6348c3dac44628e4da2bbc9c77f316f3d181158b063b0e467ed31221d0ec73af1fb004142263c86ca4f9e86f6fcf1a9ecd3d5b67e1fcc5b401167d8d24e7aad13292a8e54f53416fc7ad018b71884997baa61969106ac7548c29301d86d2c3f5b5aff81f95b91cd6c8c1f4d77f8553740a02fa8c4beb283be8a39c8bb6bcfc35bcba9946b52483eadbb62befff8993685b996f031e95e90e92f82de0e0fa8562d26620d8bfe70a9ba933af6f33649fb4c17b2246afd0b7533c7fe11c805e871286df9f434d56a4f4c97025ebee9481c8bf65387171ece6b4ece604f92aae1a601c9e6a62f470754719ef6ab80a878f81a7df8f861f3c07109b226ade838142c8f6ef1d8ca1 examples/janusV2_transparent_cipherOut.mpcl
type Evaluator struct {
	// privShare [32]byte
	privShare uint512
	hTwo      [55]byte
	hZero     [50]byte
	hThree    [55]byte
	hThreeC   [55]byte
	ivLabel   [13]byte
	keyLabel  [14]byte
	ciph      [16000]byte
	// cipherHashReq [32]byte
	// cipherHashRes [32]byte
}

func main(g Garbler, e Evaluator) ([]byte, []byte, uint8) { // uint8, ([]byte, []byte), []byte

	rZero := []byte{0x0}
	// rOne := []byte{0x1}

	// combine secret shares into DHE
	DHE := (g.privShare + e.privShare) % g.modP
	bytesDHE := uint512ToByte(DHE)[32:]
	// compute HS
	HS := hmac.SumSHA256(bytesDHE[:], g.dES)

	// compute SHTS
	var mH2 [55]byte
	// must be set individually because 0x00 start is discarded when parsed
	mH2[0] = 0x00
	for i := 1; i < 55; i++ {
		mH2[i] = e.hTwo[i-1]
	}
	SHTS := hmac.SumSHA256(mH2[:], HS)

	// check SHTS against public input
	for i := 0; i < 32; i++ {
		if (SHTS[i] ^ g.SHTS[i]) != 0x00 {
			return rZero[:], rZero[:], 0x00
		}
	}

	// compute dHS
	var mH0 [50]byte
	mH0[0] = 0x00
	for i := 1; i < 50; i++ {
		mH0[i] = e.hZero[i-1]
	}
	dHS := hmac.SumSHA256(mH0[:], HS)

	// compute MS
	var zeros32 [32]byte
	MS := hmac.SumSHA256(zeros32[:], dHS)

	// compute CATS
	var mH3c [55]byte
	mH3c[0] = 0x00
	for i := 1; i < 55; i++ {
		mH3c[i] = e.hThreeC[i-1]
	}
	CATS := hmac.SumSHA256(mH3c[:], MS)

	// compute iv (to be disclosed in plain)
	var mIv [13]byte
	mIv[0] = 0x00
	for i := 1; i < 13; i++ {
		mIv[i] = e.ivLabel[i-1]
	}
	civ := hmac.SumSHA256(mIv[:], CATS)[:12]

	// compute client traffic key
	var mKey [14]byte
	mKey[0] = 0x00
	for i := 1; i < 14; i++ {
		mKey[i] = e.keyLabel[i-1]
	}
	ckey := hmac.SumSHA256(mKey[:], CATS)[:16]

	// compute SATS
	var mH3 [55]byte
	mH3[0] = 0x00
	for i := 1; i < 55; i++ {
		mH3[i] = e.hThree[i-1]
	}
	SATS := hmac.SumSHA256(mH3[:], MS)

	// compute iv (to be disclosed in plain)
	iv := hmac.SumSHA256(mIv[:], SATS)[:12]

	// compute server traffic key
	key := hmac.SumSHA256(mKey[:], SATS)[:16]

	// compute request ecbs (check input correctness)
	var czeros16 [16]byte
	cECBK := aes.Block128(ckey, czeros16)
	cnonce := getNonce(civ, 1)
	cECB1 := aes.Block128(ckey, cnonce)

	// match ecb0, ecb1 against public input
	for i := 0; i < 16; i++ {
		if (cECB1[i] ^ g.cECB1[i]) != 0x00 {
			return rZero[:], rZero[:], 0x00
		}
		if (cECBK[i] ^ g.cECB0[i]) != 0x00 {
			return rZero[:], rZero[:], 0x00
		}
	}

	// compute response ecbs
	var zeros16 [16]byte
	ECBK := aes.Block128(key, zeros16)
	nonce := getNonce(iv, 1)
	ECB1 := aes.Block128(key, nonce)
	var counter [aes.BlockSize]byte
	counter = memcpy(counter, 0, iv, 0)
	counter = incr(counter)

	// match ecb0, ecb1 against public input
	for i := 0; i < 16; i++ {
		if (ECB1[i] ^ g.ECB1[i]) != 0x00 {
			return rZero[:], rZero[:], 0x00
		}
		if (ECBK[i] ^ g.ECB0[i]) != 0x00 {
			return rZero[:], rZero[:], 0x00
		}
	}

	// server side response ecb verification
	var block [aes.BlockSize]byte
	numberChunks := (1000 * 16)
	var cipher1 [numberChunks]byte

	// loop increments with 16 step size
	for i := 0; i < numberChunks; i += aes.BlockSize {
		counter = incr(counter)
		block = aes.Block128(key, counter)
		for j := 0; j < aes.BlockSize; j++ {
			cipher1[i+j] = block[j] ^ g.plainChunk[j]

			if (cipher1[i+j] ^ e.ciph[i+j]) != 0 {
				return rZero[:], rZero[:], 0x00
			}
		}
	}

	// compute hash on cipherChunks
	// hash1 := sha256.Sum256(cipher1[:])

	// // compare hash
	// for i := 0; i < 32; i++ {
	// 	if (hash1[i] ^ e.cipherHashRes[i]) != 0 {
	// 		return 0x00
	// 	}
	// }

	// client request parity check, no need to verify SHTS twice and must not check ecb0,ecb1
	var block2 [aes.BlockSize]byte
	numberChunks2 := (16 * 16)
	var cipher2 [numberChunks2]byte

	var counter2 [aes.BlockSize]byte
	counter2 = memcpy(counter2, 0, civ, 0)
	counter2 = incr(counter2)
	for i := 0; i < numberChunks2; i += aes.BlockSize {
		counter2 = incr(counter2)
		block2 = aes.Block128(ckey, counter2)
		for j := 0; j < aes.BlockSize; j++ {
			cipher2[i+j] = block2[j] ^ g.plainChunk[j]

			// if (cipher2[i+j] ^ g.cipherChunkReq[i+j]) != 0 {
			// 	// return 0x00
			// }
		}

	}

	// compute hash on cipherChunks
	// hash2 := sha256.Sum256(cipher2[:])

	// // compare hash
	// for i := 0; i < 32; i++ {
	// 	if (hash2[i] ^ e.cipherHashReq[i]) != 0 {
	// 		return 0x00
	// 	}
	// }

	return cipher1[:], cipher2[:], 0x01
	// return sha256.Sum256(cipher1[:]), sha256.Sum256(cipher2[:])

	// var temp [1]byte
	// temp[0] = 0x01
	// return 0x01
}

func byteToUint128(x [16]byte) uint128 {
	var r uint128

	for i := 0; i < len(x); i++ {
		r <<= 8
		r |= uint128(x[i])
	}
	return r
}

func uint128ToByte(x uint128) [16]byte {
	var r [16]byte

	for i := 0; i < 16; i++ {
		r[15-i] = x & 0xff
		x >>= 8
	}
	return r
}

func incr(counter [aes.BlockSize]byte) [aes.BlockSize]byte {
	var c uint32

	for i := 0; i < 4; i++ {
		c <<= 8
		c |= uint32(counter[12+i])
	}
	c++
	for i := 0; i < 4; i++ {
		counter[15-i] = c & 0xff
		c >>= 8
	}
	return counter
}

func memcpy(dst []byte, dstOfs int, src []byte, srcOfs int) []byte {
	for i := 0; srcOfs+i < len(src) && dstOfs+i < len(dst); i++ {
		dst[dstOfs+i] = src[srcOfs+i]
	}
	return dst
}

func byteToUint512(x [64]byte) uint512 {
	var r uint512

	for i := 0; i < len(x); i++ {
		r <<= 8
		r |= uint512(x[i])
	}
	return r
}

func uint512ToByte(x uint512) [64]byte {
	var r [64]byte

	for i := 0; i < 64; i++ {
		r[63-i] = x & 0xff
		x >>= 8
	}
	return r
}

func getNonce(iv [12]byte, counter uint32) [16]byte {
	var nonce [16]byte
	for i := 0; i < 12; i++ {
		nonce[i] = iv[i]
	}
	// var counter uint32
	// counter = 1
	counterBytes := uint32ToByte(counter)
	for i := 0; i < 4; i++ {
		nonce[12+i] = counterBytes[i]
	}
	return nonce
}

func uint32ToByte(x uint32) [4]byte {
	var r [4]byte

	for i := 0; i < 4; i++ {
		r[3-i] = x & 0xff
		x >>= 8
	}
	return r
}
